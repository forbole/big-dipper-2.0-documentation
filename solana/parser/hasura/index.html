<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.4">
<title data-react-helmet="true">3. Setup and run Hasura | Big Dipper 2.0 Documentation</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://docs.bigdipper.live/solana/parser/hasura"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="3. Setup and run Hasura | Big Dipper 2.0 Documentation"><meta data-react-helmet="true" name="description" content="Once you have successfully started SolJuno, the last step is to set up Hasura to expose the parsed data using a GraphQL endpoint. To do this you have to:"><meta data-react-helmet="true" property="og:description" content="Once you have successfully started SolJuno, the last step is to set up Hasura to expose the parsed data using a GraphQL endpoint. To do this you have to:"><meta data-react-helmet="true" property="og:image" content="https://docs.bigdipper.live/assets/cover.png"><meta data-react-helmet="true" name="twitter:image" content="https://docs.bigdipper.live/assets/cover.png"><link data-react-helmet="true" rel="shortcut icon" href="/assets/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://docs.bigdipper.live/solana/parser/hasura"><link data-react-helmet="true" rel="alternate" href="https://docs.bigdipper.live/solana/parser/hasura" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://docs.bigdipper.live/solana/parser/hasura" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.bd168e87.css">
<link rel="preload" href="/assets/js/runtime~main.b50db35d.js" as="script">
<link rel="preload" href="/assets/js/main.9cbeb291.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><a class="navbar__brand" href="/"><img src="/assets/logo.png" alt="Big Dipper logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/assets/logo.png" alt="Big Dipper logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">Big Dipper 2.0 Documentation</b></a></div><div class="navbar__items navbar__items--right"><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button" title="Scroll to top"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/">Overview</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Cosmos Based Chains</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Solana</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/solana/overview">Overview</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#" tabindex="0">SolJuno</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/solana/parser/overview">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/solana/parser/database">1. Setup the database</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/solana/parser/setup">2. Setup and run SolJuno</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/solana/parser/hasura">3. Setup and run Hasura</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Config reference</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Big Dipper UI</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="markdown"><header><h1 class="h1Heading_27L5">3. Setup and run Hasura</h1></header><p>Once you have successfully started SolJuno, the last step is to set up <a href="https://hasura.io/" target="_blank" rel="noopener noreferrer">Hasura</a> to expose the parsed data using a GraphQL endpoint. To do this you have to:</p><ol><li>Install Hasura</li><li>Import the metadata we provide you with</li><li>Configure Hasura Actions </li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="installing-hasura"></a>Installing Hasura<a class="hash-link" href="#installing-hasura" title="Direct link to heading">#</a></h2><p>The easiest way to install Hasura is to follow the <a href="https://hasura.io/docs/latest/graphql/core/getting-started/docker-simple.html" target="_blank" rel="noopener noreferrer">official guide</a>. This will allow you to have a Hasura instance up and running in a matter of minutes.</p><div class="admonition admonition-caution alert alert--warning"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>env variables</h5></div><div class="admonition-content"><p>When starting Hasura, make sure you specify the following environmental variables:</p><ul><li><strong>Role:</strong></li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">-e HASURA_GRAPHQL_UNAUTHORIZED_ROLE=&quot;anonymous&quot;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>This will make sure that even non-authenticated users will be able to access the endpoint correctly.</p><ul><li><strong>Hasura Actions Base URL:</strong></li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">-e ACTION_BASE_URL=&quot;[Base URL for Hasura Actions Handlers]&quot;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>This allows you to set up custom endpoints for Hasura Actions handlers. </p><p>By default, the Hasura Actions service runs on <code>http://localhost:3000</code>, so you may want to set it up as below: </p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">-e ACTION_BASE_URL=&quot;http://localhost:3000&quot;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></div></div><p>To verify if the docker container is running with success run:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">$ docker </span><span class="token function" style="color:#d73a49">ps</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>It should return the list of running Docker containers and the output should look similar to this:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">CONTAINER ID   IMAGE                          COMMAND                  CREATED        STATUS        PORTS     NAMES</span></span><span class="token-line" style="color:#393A34"><span class="token plain">aa7b17f7fe4b   hasura/graphql-engine:v2.0.3   &quot;graphql-engine serve&quot;   1 minute ago   Up 1 minute             hasura-soljuno</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Once this is done, you will also need to install <a href="https://hasura.io/docs/latest/graphql/core/hasura-cli/install-hasura-cli.html#install-hasura-cli" target="_blank" rel="noopener noreferrer">Hasura CLI</a> on the same machine where you cloned the SolJuno repository.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="importing-the-metadata"></a>Importing the metadata<a class="hash-link" href="#importing-the-metadata" title="Direct link to heading">#</a></h2><p>When you have installed both Hasura and Hasura CLI, you are now ready to import the metadata. This will allow you to easily set up all the queries that BigDipper will later need. To do this, you can simply run the following commands:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Change to hasura directory inside soljuno repository</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token builtin class-name">cd</span><span class="token plain"> /path/to/soljuno/hasura</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Import the metadata into the remote server</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">$ hasura metadata apply --endpoint </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">your-endpoint</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> --admin-secret </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">hasura_password</span><span class="token operator" style="color:#393A34">&gt;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Verify endpoint  </h5></div><div class="admonition-content"><p>Make sure that <code>&lt;your-endpoint&gt;</code> represents your full GraphQL endpoint (eg. <code>http://localhost:8080</code>) and <code>&lt;hasura_password&gt;</code> matches the console secret you specified while starting Hasura. You can remove the flag if you did not use a secret.</p><p>Once the metadata is successfully applied, you will be able to start using it properly.</p></div></div><div class="admonition admonition-caution alert alert--warning"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Metadata error    </h5></div><div class="admonition-content"><p>If Hasura is complaining about metadata not being valid after importing them, please head into the <em>Metadata status</em> page, delete all the metadata, and try re-importing them. This should fix all the issues.</p></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="configuring-hasura-actions"></a>Configuring Hasura Actions<a class="hash-link" href="#configuring-hasura-actions" title="Direct link to heading">#</a></h2><p>Hasura Actions allows querying certain address-specific data from the node when needed instead of storing it in the database. It starts on <code>soljuno proxy-start</code> command and runs together with SolJuno on the same instance, it runs by default on port <code>3000</code>.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="testing-hasura-actions"></a>Testing Hasura Actions<a class="hash-link" href="#testing-hasura-actions" title="Direct link to heading">#</a></h3><p>To verify if Hasura Actions are working properly you should run a test query eg.:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">$ curl http://localhost:3000/api/account_info \</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    --data &#x27;{ &quot;input&quot;: { &quot;address&quot;: &quot;forb5u56XgvzxiKfRt4FVNFQKJrd2LWAfNCsCqL6P7q&quot;} }&#x27;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>It should return the account balance and the output should look similar to this:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">{&quot;data&quot;:[&quot;&quot;,&quot;base64&quot;],&quot;executable&quot;:false,&quot;lamports&quot;:173449890215,&quot;program_owner&quot;:&quot;11111111111111111111111111111111&quot;,&quot;rent_epoch&quot;:317,&quot;parsed&quot;:null}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></div><footer class="row docusaurus-mt-lg"><div class="col"></div><div class="col lastUpdated_3DPF">Last updated on <b><time datetime="2022-10-31T09:36:17.000Z">10/31/2022</time></b></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/solana/parser/setup"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« 2. Setup and run SolJuno</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/solana/parser/config/config"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Toml format Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#installing-hasura" class="table-of-contents__link">Installing Hasura</a></li><li><a href="#importing-the-metadata" class="table-of-contents__link">Importing the metadata</a></li><li><a href="#configuring-hasura-actions" class="table-of-contents__link">Configuring Hasura Actions</a><ul><li><a href="#testing-hasura-actions" class="table-of-contents__link">Testing Hasura Actions</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"></div></div></footer></div>
<script src="/assets/js/runtime~main.b50db35d.js"></script>
<script src="/assets/js/main.9cbeb291.js"></script>
</body>
</html>